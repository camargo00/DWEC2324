<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscaminas Personalizable</title>
    <style>
        #tablero {
            display: grid;
            gap: 2px;
            grid-template-columns: repeat(10, 30px); /* Ajusta el número de columnas según tus necesidades */
            border: 2px solid #333;
        }

        .casilla {
            width: 30px;
            height: 30px;
            background-color: #eee;
            border: 1px solid #ccc;
            text-align: center;
            line-height: 30px;
            cursor: pointer;
        }

        .mina {
            display: none;
        }
    </style>
</head>
<body>
    <h1>Buscaminas Personalizable</h1>
    <label for="filas">Filas:</label>
    <input type="number" id="filas" value="10" min="1">
    <label for="columnas">Columnas:</label>
    <input type="number" id="columnas" value="10" min="1">
    <label for="minas">Minas:</label>
    <input type="number" id="minas" value="10" min="1">
    <button onclick="iniciarJuego()">Iniciar Juego</button>

    <div id="tablero"></div>

    <script>
        let filas = 10;
        let columnas = 10;
        let minas = 10;

        function iniciarJuego() {
            filas = parseInt(document.getElementById("filas").value);
            columnas = parseInt(document.getElementById("columnas").value);
            minas = parseInt(document.getElementById("minas").value);

            generarTablero();
        }

        function generarTablero() {
            const tablero = document.getElementById("tablero");
            tablero.innerHTML = "";

            for (let i = 0; i < filas; i++) {
                for (let j = 0; j < columnas; j++) {
                    const casilla = document.createElement("div");
                    casilla.classList.add("casilla");
                    casilla.setAttribute("data-fila", i);
                    casilla.setAttribute("data-columna", j);
                    casilla.onclick = destaparCasilla;
                    tablero.appendChild(casilla);
                }
            }

            colocarMinas();
        }

        function colocarMinas() {
            const casillas = document.querySelectorAll(".casilla");
            const casillasArray = Array.from(casillas);
            const minasArray = Array(minas).fill("mina");

            const casillasConMinas = casillasArray.sort(() => Math.random() - 0.5).slice(0, minas);
            casillasConMinas.forEach(casilla => casilla.classList.add("mina"));
        }

        function destaparCasilla() {
            if (this.classList.contains("mina")) {
                alert("¡Has perdido!");
                reiniciarJuego();
            } else {
                const fila = this.getAttribute("data-fila");
                const columna = this.getAttribute("data-columna");
                const minasCercanas = contarMinasCercanas(parseInt(fila), parseInt(columna));
                this.innerHTML = minasCercanas > 0 ? minasCercanas : "";
                this.style.backgroundColor = "#ddd";
                this.onclick = null;

                if (minasCercanas === 0) {
                    destaparCasillasCercanas(parseInt(fila), parseInt(columna));
                }
            }
        }

        function contarMinasCercanas(fila, columna) {
            let contador = 0;

            for (let i = Math.max(0, fila - 1); i <= Math.min(filas - 1, fila + 1); i++) {
                for (let j = Math.max(0, columna - 1); j <= Math.min(columnas - 1, columna + 1); j++) {
                    if (!(i === fila && j === columna)) {
                        const casillaCercana = document.querySelector(`.casilla[data-fila="${i}"][data-columna="${j}"]`);
                        if (casillaCercana && casillaCercana.classList.contains("mina")) {
                            contador++;
                        }
                    }
                }
            }

            return contador;
        }

        function destaparCasillasCercanas(fila, columna) {
            for (let i = Math.max(0, fila - 1); i <= Math.min(filas - 1, fila + 1); i++) {
                for (let j = Math.max(0, columna - 1); j <= Math.min(columnas - 1, columna + 1); j++) {
                    const casillaCercana = document.querySelector(`.casilla[data-fila="${i}"][data-columna="${j}"]`);
                    if (casillaCercana && !casillaCercana.classList.contains("mina") && casillaCercana.innerHTML === "") {
                        destaparCasilla.call(casillaCercana);
                    }
                }
            }
        }

        function reiniciarJuego() {
            generarTablero();
        }

        // Iniciar juego al cargar la página
        window.onload = iniciarJuego;
    </script>
</body>
</html>
